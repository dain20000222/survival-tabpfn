==================================================

Processing dataset: aids
Original dataset shape: (1405, 9)
Number of unique patients: 467
Percentage of censored patients: 59.7%
Example patient data: [['10.677078252' 'ddC' 'male' 'AIDS' 'intolerance']
 ['8.4261497732' 'ddC' 'male' 'AIDS' 'intolerance']
 ['9.4339811321' 'ddC' 'male' 'AIDS' 'intolerance']]
Example patient times: [ 6.   12.   16.97]
Example patient events: [0 0 0]
Train patients: 326, Val patients: 70, Test patients: 71
Evaluation time points: [2.4, 3.4, 5.53, 7.17, 8.47, 10.23, 11.3, 12.3, 15.07]

Starting hyperparameter tuning...

Best validation NLL: 636.5727 (configuration 53)

Evaluating on test set...
Predicted risk shape: (71, 9, 5)
Predicted survival shape: (71, 9, 5)
Risk NaN count: 1251
Survival NaN count: 1251
WARNING: Found 1251 NaN values in risk predictions
Replaced NaN values in risk predictions with 0.1
WARNING: Found 1251 NaN values in survival predictions
Replaced NaN values in survival predictions with 0.5
After NaN handling - Risk NaN count: 0
After NaN handling - Survival NaN count: 0
Risk prediction dimensions: patients=71, times=9, risks=5
Evaluation times length: 9
Sample risk predictions (first patient, all times):
  Time step 0: [0.07078624 0.04143239 0.01716501 0.00229616 0.1       ]
  Time step 1: [0.1257687  0.06979221 0.02431032 0.00288535 0.1       ]
  Time step 2: [0.20529567 0.12017491 0.038579   0.00460534 0.1       ]
  Time step 3: [0.2677047  0.15641959 0.04962352 0.00572797 0.1       ]
  Time step 4: [0.34177878 0.20389565 0.06857818 0.00857632 0.1       ]
Sample survival predictions (first patient, all times):
  Time step 0: [0.92921376 0.95856761 0.98283499 0.99770384 0.5       ]
  Time step 1: [0.8742313  0.93020779 0.97568968 0.99711465 0.5       ]
  Time step 2: [0.79470433 0.87982509 0.961421   0.99539466 0.5       ]
  Time step 3: [0.7322953  0.84358041 0.95037648 0.99427203 0.5       ]
  Time step 4: [0.65822122 0.79610435 0.93142182 0.99142368 0.5       ]
Structured train array shape: (396,)
Structured test array shape: (71,)
Example structured train data: [(False, 12.23) (False, 14.6 ) (False, 12.27) ( True, 14.7 )
 ( True, 15.7 )]
Example structured test data: [(False, 13.9 ) ( True, 10.7 ) ( True,  9.37) (False, 15.97)
 ( True, 11.13)]
Computing metrics for time point 1/9 (time=2.40)
Risk predictions for time 0: min=0.1030, max=0.4958, mean=0.3196
C-index for time 2.40: 0.8889
AUC for time 2.40: 0.8971
Computing metrics for time point 2/9 (time=3.40)
Risk predictions for time 1: min=0.1251, max=0.6457, mean=0.4114
C-index for time 3.40: 0.7556
AUC for time 3.40: 0.7699
Computing metrics for time point 3/9 (time=5.53)
Risk predictions for time 2: min=0.1543, max=0.8947, mean=0.5434
C-index for time 5.53: 0.5965
AUC for time 5.53: 0.5968
Computing metrics for time point 4/9 (time=7.17)
Risk predictions for time 3: min=0.1689, max=1.1116, mean=0.6506
C-index for time 7.17: 0.5618
AUC for time 7.17: 0.5683
Computing metrics for time point 5/9 (time=8.47)
Risk predictions for time 4: min=0.1921, max=1.3671, mean=0.7826
C-index for time 8.47: 0.5070
AUC for time 8.47: 0.5101
Computing metrics for time point 6/9 (time=10.23)
Risk predictions for time 5: min=0.2143, max=1.6125, mean=0.9082
C-index for time 10.23: 0.5140
AUC for time 10.23: 0.5264
Computing metrics for time point 7/9 (time=11.30)
Risk predictions for time 6: min=0.2384, max=1.8524, mean=1.0313
C-index for time 11.30: 0.5527
AUC for time 11.30: 0.6049
Computing metrics for time point 8/9 (time=12.30)
Risk predictions for time 7: min=0.2592, max=2.0687, mean=1.1458
C-index for time 12.30: 0.5407
AUC for time 12.30: 0.6087
Computing metrics for time point 9/9 (time=15.07)
Risk predictions for time 8: min=0.3178, max=2.3810, mean=1.3307
C-index for time 15.07: 0.5201
AUC for time 15.07: 0.6217
Survival predictions shape for Brier score: (71, 9)
Brier score computed: 0.1652
==================================================
Final test results for dataset aids:
Number of patients: 467
Number of eval time points: 9
Validation NLL: 636.5727
Test C-index: 0.5201
Test Brier Score: 0.1652
Test mean AUC: 0.6338
==================================================

Processing dataset: csl
Original dataset shape: (2481, 10)
Number of unique patients: 446
Percentage of censored patients: 39.5%
Example patient data: [[-12.  31.  38.  38.   0.   1.]
 [-12.  27.  31.  38.   0.   1.]]
Example patient times: [0.24383562 0.41369863]
Example patient events: [0 1]
Train patients: 312, Val patients: 67, Test patients: 67
Evaluation time points: [0.3709589041095894, 0.610958904109589, 1.0438356164383567, 1.846027397260278, 2.49315068493151, 3.1747945205479478, 4.309041095890415, 5.4602739726027405, 7.464109589041098]

Starting hyperparameter tuning...

Best validation NLL: 302.3020 (configuration 11)

Evaluating on test set...
Predicted risk shape: (67, 9, 13)
Predicted survival shape: (67, 9, 13)
Risk NaN count: 4806
Survival NaN count: 4806
WARNING: Found 4806 NaN values in risk predictions
Replaced NaN values in risk predictions with 0.1
WARNING: Found 4806 NaN values in survival predictions
Replaced NaN values in survival predictions with 0.5
After NaN handling - Risk NaN count: 0
After NaN handling - Survival NaN count: 0
Risk prediction dimensions: patients=67, times=9, risks=13
Evaluation times length: 9
Sample risk predictions (first patient, all times):
  Time step 0: [0.2461064  0.09457492 0.02388417 0.1        0.1        0.1
 0.1        0.1        0.1        0.1        0.1        0.1
 0.1       ]
  Time step 1: [0.39472207 0.20053051 0.10354491 0.1        0.1        0.1
 0.1        0.1        0.1        0.1        0.1        0.1
 0.1       ]
  Time step 2: [0.48759437 0.25237889 0.15275319 0.1        0.1        0.1
 0.1        0.1        0.1        0.1        0.1        0.1
 0.1       ]
  Time step 3: [0.56910019 0.315286   0.24119821 0.1        0.1        0.1
 0.1        0.1        0.1        0.1        0.1        0.1
 0.1       ]
  Time step 4: [0.66667305 0.38850027 0.32434096 0.1        0.1        0.1
 0.1        0.1        0.1        0.1        0.1        0.1
 0.1       ]
Sample survival predictions (first patient, all times):
  Time step 0: [0.7538936  0.90542508 0.97611583 0.5        0.5        0.5
 0.5        0.5        0.5        0.5        0.5        0.5
 0.5       ]
  Time step 1: [0.60527793 0.79946949 0.89645509 0.5        0.5        0.5
 0.5        0.5        0.5        0.5        0.5        0.5
 0.5       ]
  Time step 2: [0.51240563 0.74762111 0.84724681 0.5        0.5        0.5
 0.5        0.5        0.5        0.5        0.5        0.5
 0.5       ]
  Time step 3: [0.43089981 0.684714   0.75880179 0.5        0.5        0.5
 0.5        0.5        0.5        0.5        0.5        0.5
 0.5       ]
  Time step 4: [0.33332695 0.61149973 0.67565904 0.5        0.5        0.5
 0.5        0.5        0.5        0.5        0.5        0.5
 0.5       ]
Structured train array shape: (379,)
Structured test array shape: (67,)
Example structured train data: [( True, 0.56712329) ( True, 0.58082192) (False, 0.26027397)
 ( True, 1.31232877) ( True, 8.43287671)]
Example structured test data: [( True, 0.63013699) (False, 0.52876712) ( True, 0.11780822)
 ( True, 8.88219178) ( True, 0.52876712)]
Computing metrics for time point 1/9 (time=0.37)
Risk predictions for time 0: min=0.3933, max=1.6294, mean=1.1339
C-index for time 0.37: 0.8735
AUC for time 0.37: 0.8889
Computing metrics for time point 2/9 (time=0.61)
Risk predictions for time 1: min=0.6150, max=2.1644, mean=1.5034
C-index for time 0.61: 0.5471
AUC for time 0.61: 0.5588
Computing metrics for time point 3/9 (time=1.04)
Risk predictions for time 2: min=0.6989, max=2.6293, mean=1.7505
C-index for time 1.04: 0.3950
AUC for time 1.04: 0.3875
Computing metrics for time point 4/9 (time=1.85)
Risk predictions for time 3: min=0.8424, max=3.2666, mean=2.0687
C-index for time 1.85: 0.2733
AUC for time 1.85: 0.2705
Computing metrics for time point 5/9 (time=2.49)
Risk predictions for time 4: min=1.1225, max=3.9890, mean=2.4178
C-index for time 2.49: 0.2241
AUC for time 2.49: 0.2429
Computing metrics for time point 6/9 (time=3.17)
Risk predictions for time 5: min=1.4850, max=5.0257, mean=2.6856
C-index for time 3.17: 0.1815
AUC for time 3.17: 0.1810
Computing metrics for time point 7/9 (time=4.31)
Risk predictions for time 6: min=1.6961, max=6.0605, mean=2.9591
C-index for time 4.31: 0.1808
AUC for time 4.31: 0.1362
Computing metrics for time point 8/9 (time=5.46)
Risk predictions for time 7: min=1.7586, max=7.6464, mean=3.4485
C-index for time 5.46: 0.1552
AUC for time 5.46: 0.1155
Computing metrics for time point 9/9 (time=7.46)
Risk predictions for time 8: min=1.8544, max=9.8288, mean=4.0978
C-index for time 7.46: 0.1792
AUC for time 7.46: 0.1536
Survival predictions shape for Brier score: (67, 9)
Brier score computed: 0.2239
==================================================
Final test results for dataset csl:
Number of patients: 446
Number of eval time points: 9
Validation NLL: 302.3020
Test C-index: 0.1792
Test Brier Score: 0.2239
Test mean AUC: 0.3261
==================================================

Processing dataset: epileptic
Original dataset shape: (1286, 9)
Number of unique patients: 605
Percentage of censored patients: 63.5%
Example patient data: [['2.0' '75.67' 'CBZ' 'M' 'No']
 ['2.67' '75.67' 'CBZ' 'M' 'No']
 ['3.33' '75.67' 'CBZ' 'M' 'No']
 ['2.67' '75.67' 'CBZ' 'M' 'No']]
Example patient times: [  86.  451. 2022. 2400.]
Example patient events: [0 0 0 0]
Train patients: 423, Val patients: 91, Test patients: 91
Evaluation time points: [85.2, 147.4, 182.0, 231.6, 323.0, 394.2, 518.8000000000001, 664.0, 883.1999999999999]

Starting hyperparameter tuning...

Best validation NLL: 644.5230 (configuration 26)

Evaluating on test set...
Predicted risk shape: (91, 9, 8)
Predicted survival shape: (91, 9, 8)
Risk NaN count: 4842
Survival NaN count: 4842
WARNING: Found 4842 NaN values in risk predictions
Replaced NaN values in risk predictions with 0.1
WARNING: Found 4842 NaN values in survival predictions
Replaced NaN values in survival predictions with 0.5
After NaN handling - Risk NaN count: 0
After NaN handling - Survival NaN count: 0
Risk prediction dimensions: patients=91, times=9, risks=8
Evaluation times length: 9
Sample risk predictions (first patient, all times):
  Time step 0: [0.09692713 0.03518674 0.01714331 0.01067646 0.1        0.1
 0.1        0.1       ]
  Time step 1: [0.17403159 0.06906553 0.03412538 0.02110585 0.1        0.1
 0.1        0.1       ]
  Time step 2: [0.2610396  0.10946102 0.05514131 0.0349811  0.1        0.1
 0.1        0.1       ]
  Time step 3: [0.29814094 0.12871794 0.06662547 0.04309341 0.1        0.1
 0.1        0.1       ]
  Time step 4: [0.37475066 0.19849289 0.11790575 0.08531284 0.1        0.1
 0.1        0.1       ]
Sample survival predictions (first patient, all times):
  Time step 0: [0.90307287 0.96481326 0.98285669 0.98932354 0.5        0.5
 0.5        0.5       ]
  Time step 1: [0.82596841 0.93093447 0.96587462 0.97889415 0.5        0.5
 0.5        0.5       ]
  Time step 2: [0.7389604  0.89053898 0.94485869 0.9650189  0.5        0.5
 0.5        0.5       ]
  Time step 3: [0.70185906 0.87128206 0.93337453 0.95690659 0.5        0.5
 0.5        0.5       ]
  Time step 4: [0.62524934 0.80150711 0.88209425 0.91468716 0.5        0.5
 0.5        0.5       ]
Structured train array shape: (514,)
Structured test array shape: (91,)
Example structured train data: [(False,  496.) ( True,  276.) (False,  479.) (False, 1483.)
 (False, 1829.)]
Example structured test data: [(False, 1205.) (False,  548.) ( True,  113.) (False, 1829.)
 ( True, 1813.)]
Computing metrics for time point 1/9 (time=85.20)
Risk predictions for time 0: min=0.1672, max=0.8093, mean=0.7167
C-index for time 85.20: 0.9237
AUC for time 85.20: 0.9302
Computing metrics for time point 2/9 (time=147.40)
Risk predictions for time 1: min=0.3184, max=0.8937, mean=0.8199
C-index for time 147.40: 0.7893
AUC for time 147.40: 0.7988
Computing metrics for time point 3/9 (time=182.00)
Risk predictions for time 2: min=0.4867, max=1.0359, mean=0.9386
C-index for time 182.00: 0.5131
AUC for time 182.00: 0.5047
Computing metrics for time point 4/9 (time=231.60)
Risk predictions for time 3: min=0.5288, max=1.1647, mean=0.9959
C-index for time 231.60: 0.3797
AUC for time 231.60: 0.3667
Computing metrics for time point 5/9 (time=323.00)
Risk predictions for time 4: min=0.8003, max=1.4153, mean=1.1307
C-index for time 323.00: 0.2768
AUC for time 323.00: 0.2690
Computing metrics for time point 6/9 (time=394.20)
Risk predictions for time 5: min=0.9991, max=1.6838, mean=1.2662
C-index for time 394.20: 0.2898
AUC for time 394.20: 0.2788
Computing metrics for time point 7/9 (time=518.80)
Risk predictions for time 6: min=1.0289, max=1.9632, mean=1.3860
C-index for time 518.80: 0.3263
AUC for time 518.80: 0.3051
Computing metrics for time point 8/9 (time=664.00)
Risk predictions for time 7: min=1.1409, max=2.4355, mean=1.6275
C-index for time 664.00: 0.3497
AUC for time 664.00: 0.3408
Computing metrics for time point 9/9 (time=883.20)
Risk predictions for time 8: min=1.2130, max=3.4330, mean=1.9255
C-index for time 883.20: 0.3340
AUC for time 883.20: 0.2805
Survival predictions shape for Brier score: (91, 9)
Brier score computed: 0.1974
==================================================
Final test results for dataset epileptic:
Number of patients: 605
Number of eval time points: 9
Validation NLL: 644.5230
Test C-index: 0.3340
Test Brier Score: 0.1974
Test mean AUC: 0.4527
==================================================

Processing dataset: FRTCS
Original dataset shape: (2091, 9)
Number of unique patients: 697
Percentage of censored patients: 89.7%
Example patient data: [['65.0' '94.0' '63.0' 'F' 'N']
 ['65.0' '109.0' '59.5' 'F' 'N']
 ['65.0' '107.5' '56.0' 'F' 'N']]
Example patient times: [ 853. 1588. 1826.]
Example patient events: [0 0 0]
Train patients: 487, Val patients: 105, Test patients: 105
Evaluation time points: [1450.2, 1499.0, 1542.0, 1591.8, 1626.5, 1646.4, 1725.2, 1760.0, 1794.7]

Starting hyperparameter tuning...
Error processing dataset FRTCS: can't convert np.ndarray of type numpy.object_. The only supported types are: float64, float32, float16, complex64, complex128, int64, int32, int16, int8, uint8, and bool.
==================================================

Processing dataset: heart
Original dataset shape: (172, 8)
Number of unique patients: 103
Percentage of censored patients: 27.2%
Example patient data: [[-17.15537303   0.12320329   0.           0.        ]]
Example patient times: [50.]
Example patient events: [1]
Train patients: 71, Val patients: 16, Test patients: 16
Evaluation time points: [16.0, 21.0, 40.0, 53.0, 69.0, 96.0, 188.0, 308.0, 733.0]

Starting hyperparameter tuning...

Best validation NLL: 75.7557 (configuration 50)

Evaluating on test set...
Predicted risk shape: (16, 9, 2)
Predicted survival shape: (16, 9, 2)
Risk NaN count: 54
Survival NaN count: 54
WARNING: Found 54 NaN values in risk predictions
Replaced NaN values in risk predictions with 0.1
WARNING: Found 54 NaN values in survival predictions
Replaced NaN values in survival predictions with 0.5
After NaN handling - Risk NaN count: 0
After NaN handling - Survival NaN count: 0
Risk prediction dimensions: patients=16, times=9, risks=2
Evaluation times length: 9
Sample risk predictions (first patient, all times):
  Time step 0: [0.1285644 0.1      ]
  Time step 1: [0.22313637 0.1       ]
  Time step 2: [0.36283131 0.1       ]
  Time step 3: [0.46971006 0.1       ]
  Time step 4: [0.54192263 0.1       ]
Sample survival predictions (first patient, all times):
  Time step 0: [0.8714356 0.5      ]
  Time step 1: [0.77686363 0.5       ]
  Time step 2: [0.63716869 0.5       ]
  Time step 3: [0.53028994 0.5       ]
  Time step 4: [0.45807737 0.5       ]
Structured train array shape: (87,)
Structured test array shape: (16,)
Example structured train data: [( True,  17.) ( True,  28.) ( True,   6.) ( True, 100.) ( True,   3.)]
Example structured test data: [( True,   9.) ( True, 207.) ( True,   2.) ( True,  78.) ( True,  30.)]
Computing metrics for time point 1/9 (time=16.00)
Risk predictions for time 0: min=0.2011, max=0.2595, mean=0.2215
C-index for time 16.00: 0.3438
AUC for time 16.00: 0.3455
Computing metrics for time point 2/9 (time=21.00)
Risk predictions for time 1: min=0.3020, max=0.4909, mean=0.3761
C-index for time 21.00: 0.0781
AUC for time 21.00: 0.0000
Computing metrics for time point 3/9 (time=40.00)
Risk predictions for time 2: min=0.3943, max=0.6998, mean=0.5450
C-index for time 40.00: 0.2317
AUC for time 40.00: 0.2013
Computing metrics for time point 4/9 (time=53.00)
Risk predictions for time 3: min=0.4942, max=0.9249, mean=0.7239
C-index for time 53.00: 0.2452
AUC for time 53.00: 0.2179
Computing metrics for time point 5/9 (time=69.00)
Risk predictions for time 4: min=0.5700, max=1.0689, mean=0.8553
C-index for time 69.00: 0.2684
AUC for time 69.00: 0.2561
Computing metrics for time point 6/9 (time=96.00)
Risk predictions for time 5: min=0.6680, max=1.2936, mean=1.0243
C-index for time 96.00: 0.3659
AUC for time 96.00: 0.4503
Computing metrics for time point 7/9 (time=188.00)
Risk predictions for time 6: min=0.7452, max=1.3905, mean=1.1273
C-index for time 188.00: 0.4038
AUC for time 188.00: 0.4072
Computing metrics for time point 8/9 (time=308.00)
Risk predictions for time 7: min=0.8377, max=1.5499, mean=1.2746
C-index for time 308.00: 0.4171
AUC for time 308.00: 0.4462
Computing metrics for time point 9/9 (time=733.00)
Risk predictions for time 8: min=0.9376, max=1.7410, mean=1.4341
C-index for time 733.00: 0.4046
AUC for time 733.00: 0.5123
Survival predictions shape for Brier score: (16, 9)
Brier score computed: 0.2174
==================================================
Final test results for dataset heart:
Number of patients: 103
Number of eval time points: 9
Validation NLL: 75.7557
Test C-index: 0.4046
Test Brier Score: 0.2174
Test mean AUC: 0.3152
==================================================

Processing dataset: heartvalve
Original dataset shape: (984, 23)
Number of unique patients: 256
Percentage of censored patients: 78.9%
Example patient data: [['0' '3' '1' '0' '0' '1' 'Stentless valve' '1' '0' '1' '0' '1'
  '75.06027' '10.0' '118.98' '93.0' '1.77' '27.0' '103.0']
 ['0' '3' '1' '0' '0' '1' 'Stentless valve' '1' '0' '1' '0' '1'
  '75.06027' '10.0' '137.63' '93.0' '1.77' '27.0' '103.0']]
Example patient times: [0.0109589  4.95616438]
Example patient events: [0 0]
Train patients: 178, Val patients: 39, Test patients: 39
Evaluation time points: [1.1076712328769, 2.3309589041096, 2.4854794520545003, 2.7934246575346, 3.5849315068495002, 4.527671232877, 5.466849369863101, 6.233424657534401, 7.5021917808218]

Starting hyperparameter tuning...

Best validation NLL: 165.8624 (configuration 89)

Evaluating on test set...
Predicted risk shape: (39, 9, 9)
Predicted survival shape: (39, 9, 9)
Risk NaN count: 1755
Survival NaN count: 1755
WARNING: Found 1755 NaN values in risk predictions
Replaced NaN values in risk predictions with 0.1
WARNING: Found 1755 NaN values in survival predictions
Replaced NaN values in survival predictions with 0.5
After NaN handling - Risk NaN count: 0
After NaN handling - Survival NaN count: 0
Risk prediction dimensions: patients=39, times=9, risks=9
Evaluation times length: 9
Sample risk predictions (first patient, all times):
  Time step 0: [0.07797582 0.20644425 0.19967925 0.1        0.1        0.1
 0.1        0.1        0.1       ]
  Time step 1: [0.13530654 0.38019371 0.37997139 0.1        0.1        0.1
 0.1        0.1        0.1       ]
  Time step 2: [0.18372634 0.40195416 0.40324241 0.1        0.1        0.1
 0.1        0.1        0.1       ]
  Time step 3: [0.22581414 0.45087725 0.45751704 0.1        0.1        0.1
 0.1        0.1        0.1       ]
  Time step 4: [0.28356078 0.50754626 0.52117076 0.1        0.1        0.1
 0.1        0.1        0.1       ]
Sample survival predictions (first patient, all times):
  Time step 0: [0.92202418 0.79355575 0.80032075 0.5        0.5        0.5
 0.5        0.5        0.5       ]
  Time step 1: [0.86469346 0.61980629 0.62002861 0.5        0.5        0.5
 0.5        0.5        0.5       ]
  Time step 2: [0.81627366 0.59804584 0.59675759 0.5        0.5        0.5
 0.5        0.5        0.5       ]
  Time step 3: [0.77418586 0.54912275 0.54248296 0.5        0.5        0.5
 0.5        0.5        0.5       ]
  Time step 4: [0.71643922 0.49245374 0.47882924 0.5        0.5        0.5
 0.5        0.5        0.5       ]
Structured train array shape: (217,)
Structured test array shape: (39,)
Example structured train data: [(False, 3.77260274) (False, 4.95890411) (False, 2.271233  )
 (False, 7.08767123) (False, 8.43561644)]
Example structured test data: [(False, 3.331507  ) (False, 4.23835616) (False, 7.42739726)
 (False, 4.356164  ) (False, 9.8739726 )]
Computing metrics for time point 1/9 (time=1.11)
Risk predictions for time 0: min=0.6662, max=1.5025, mean=0.9760
C-index for time 1.11: 0.2368
AUC for time 1.11: 0.2368
Computing metrics for time point 2/9 (time=2.33)
Risk predictions for time 1: min=0.7837, max=2.6188, mean=1.4084
C-index for time 2.33: 0.0526
AUC for time 2.33: 0.0526
Computing metrics for time point 3/9 (time=2.49)
Risk predictions for time 2: min=0.9823, max=2.7239, mean=1.5656
C-index for time 2.49: 0.0263
AUC for time 2.49: 0.0263
Computing metrics for time point 4/9 (time=2.79)
Risk predictions for time 3: min=1.0579, max=3.0594, mean=1.8666
C-index for time 2.79: 0.0263
AUC for time 2.79: 0.0263
Computing metrics for time point 5/9 (time=3.58)
Risk predictions for time 4: min=1.1772, max=3.5624, mean=2.0790
C-index for time 3.58: 0.0584
AUC for time 3.58: 0.0616
Computing metrics for time point 6/9 (time=4.53)
Risk predictions for time 5: min=1.2039, max=3.7994, mean=2.1846
C-index for time 4.53: 0.1188
AUC for time 4.53: 0.1184
Computing metrics for time point 7/9 (time=5.47)
Risk predictions for time 6: min=1.2298, max=4.0490, mean=2.2893
C-index for time 5.47: 0.1843
AUC for time 5.47: 0.1651
Computing metrics for time point 8/9 (time=6.23)
Risk predictions for time 7: min=1.2422, max=4.2904, mean=2.3840
C-index for time 6.23: 0.1762
AUC for time 6.23: 0.1439
Computing metrics for time point 9/9 (time=7.50)
Risk predictions for time 8: min=1.4001, max=6.4374, mean=3.1850
C-index for time 7.50: 0.3008
AUC for time 7.50: 0.2119
Survival predictions shape for Brier score: (39, 9)
Brier score computed: 0.1788
==================================================
Final test results for dataset heartvalve:
Number of patients: 256
Number of eval time points: 9
Validation NLL: 165.8624
Test C-index: 0.3008
Test Brier Score: 0.1788
Test mean AUC: 0.1159
==================================================

Processing dataset: oldmort
Original dataset shape: (6495, 11)
Number of unique patients: 4603
Percentage of censored patients: 57.2%
Example patient data: [['1765.4900511304131' '22.2' 'female' 'widow' 'unknown' 'remote' 'rural']]
Example patient times: [95.813]
Example patient events: [1]
Train patients: 3221, Val patients: 691, Test patients: 691
Evaluation time points: [62.917, 65.688, 68.2552, 71.0216, 73.099, 75.37219999999999, 77.3922, 80.02260000000001, 83.9332]

Starting hyperparameter tuning...

Best validation NLL: 1059.5101 (configuration 80)

Evaluating on test set...
Predicted risk shape: (691, 9, 4)
Predicted survival shape: (691, 9, 4)
Risk NaN count: 16245
Survival NaN count: 16245
WARNING: Found 16245 NaN values in risk predictions
Replaced NaN values in risk predictions with 0.1
WARNING: Found 16245 NaN values in survival predictions
Replaced NaN values in survival predictions with 0.5
After NaN handling - Risk NaN count: 0
After NaN handling - Survival NaN count: 0
Risk prediction dimensions: patients=691, times=9, risks=4
Evaluation times length: 9
Sample risk predictions (first patient, all times):
  Time step 0: [0.07177186 0.1        0.1        0.1       ]
  Time step 1: [0.10641697 0.1        0.1        0.1       ]
  Time step 2: [0.15281135 0.1        0.1        0.1       ]
  Time step 3: [0.24281017 0.1        0.1        0.1       ]
  Time step 4: [0.27805715 0.1        0.1        0.1       ]
Sample survival predictions (first patient, all times):
  Time step 0: [0.92822814 0.5        0.5        0.5       ]
  Time step 1: [0.89358303 0.5        0.5        0.5       ]
  Time step 2: [0.84718865 0.5        0.5        0.5       ]
  Time step 3: [0.75718983 0.5        0.5        0.5       ]
  Time step 4: [0.72194285 0.5        0.5        0.5       ]
Structured train array shape: (3912,)
Structured test array shape: (691,)
Example structured train data: [( True, 73.22 ) ( True, 70.162) ( True, 79.766) (False, 63.043)
 (False, 65.   )]
Example structured test data: [( True, 87.002) (False, 74.966) (False, 70.394) ( True, 71.451)
 (False, 67.856)]
Computing metrics for time point 1/9 (time=62.92)
Risk predictions for time 0: min=0.1198, max=0.3760, mean=0.3414
C-index for time 62.92: 0.6873
AUC for time 62.92: 0.7024
Computing metrics for time point 2/9 (time=65.69)
Risk predictions for time 1: min=0.1888, max=0.4125, mean=0.3811
C-index for time 65.69: 0.6576
AUC for time 65.69: 0.6843
Computing metrics for time point 3/9 (time=68.26)
Risk predictions for time 2: min=0.3167, max=0.4604, mean=0.4385
C-index for time 68.26: 0.6544
AUC for time 68.26: 0.6908
Computing metrics for time point 4/9 (time=71.02)
Risk predictions for time 3: min=0.5320, max=0.6252, mean=0.5574
C-index for time 71.02: 0.4319
AUC for time 71.02: 0.4115
Computing metrics for time point 5/9 (time=73.10)
Risk predictions for time 4: min=0.5664, max=0.7256, mean=0.6019
C-index for time 73.10: 0.4170
AUC for time 73.10: 0.3875
Computing metrics for time point 6/9 (time=75.37)
Risk predictions for time 5: min=0.6505, max=1.0783, mean=0.7201
C-index for time 75.37: 0.4111
AUC for time 75.37: 0.3576
Computing metrics for time point 7/9 (time=77.39)
Risk predictions for time 6: min=1.0139, max=2.6835, mean=1.2388
C-index for time 77.39: 0.4622
AUC for time 77.39: 0.4746
Computing metrics for time point 8/9 (time=80.02)
Risk predictions for time 7: min=1.0814, max=2.9562, mean=1.3348
C-index for time 80.02: 0.4728
AUC for time 80.02: 0.5174
Computing metrics for time point 9/9 (time=83.93)
Risk predictions for time 8: min=1.2329, max=3.5922, mean=1.5436
C-index for time 83.93: 0.4700
AUC for time 83.93: 0.5900
Survival predictions shape for Brier score: (691, 9)
Warning: Could not compute Brier score: time must be smaller than largest observed time point: 99.969
==================================================
Final test results for dataset oldmort:
Number of patients: 4603
Number of eval time points: 9
Validation NLL: 1059.5101
Test C-index: 0.4700
Test Brier Score: 0.2500
Test mean AUC: 0.5351
==================================================

Processing dataset: Rossi
Original dataset shape: (1405, 13)
Number of unique patients: 432
Percentage of censored patients: 73.6%
Example patient data: [['no' 'black' 'no' 'not married' 'yes' '3' '3' '0' '27.0']]
Example patient times: [20.]
Example patient events: [1]
Train patients: 302, Val patients: 65, Test patients: 65
Evaluation time points: [8.0, 13.8, 18.700000000000003, 24.0, 29.0, 35.4, 40.0, 45.0, 49.0]

Starting hyperparameter tuning...

Best validation NLL: 1141.8924 (configuration 66)

Evaluating on test set...
Predicted risk shape: (65, 9, 10)
Predicted survival shape: (65, 9, 10)
Risk NaN count: 3645
Survival NaN count: 3645
WARNING: Found 3645 NaN values in risk predictions
Replaced NaN values in risk predictions with 0.1
WARNING: Found 3645 NaN values in survival predictions
Replaced NaN values in survival predictions with 0.5
After NaN handling - Risk NaN count: 0
After NaN handling - Survival NaN count: 0
Risk prediction dimensions: patients=65, times=9, risks=10
Evaluation times length: 9
Sample risk predictions (first patient, all times):
  Time step 0: [0.14095084 0.10617843 0.1        0.1        0.1        0.1
 0.1        0.1        0.1        0.1       ]
  Time step 1: [0.22240494 0.18945222 0.1        0.1        0.1        0.1
 0.1        0.1        0.1        0.1       ]
  Time step 2: [0.28486105 0.24835755 0.1        0.1        0.1        0.1
 0.1        0.1        0.1        0.1       ]
  Time step 3: [0.48624952 0.46278131 0.1        0.1        0.1        0.1
 0.1        0.1        0.1        0.1       ]
  Time step 4: [0.58133346 0.56266555 0.1        0.1        0.1        0.1
 0.1        0.1        0.1        0.1       ]
Sample survival predictions (first patient, all times):
  Time step 0: [0.85904916 0.89382157 0.5        0.5        0.5        0.5
 0.5        0.5        0.5        0.5       ]
  Time step 1: [0.77759506 0.81054778 0.5        0.5        0.5        0.5
 0.5        0.5        0.5        0.5       ]
  Time step 2: [0.71513895 0.75164245 0.5        0.5        0.5        0.5
 0.5        0.5        0.5        0.5       ]
  Time step 3: [0.51375048 0.53721869 0.5        0.5        0.5        0.5
 0.5        0.5        0.5        0.5       ]
  Time step 4: [0.41866654 0.43733445 0.5        0.5        0.5        0.5
 0.5        0.5        0.5        0.5       ]
Structured train array shape: (367,)
Structured test array shape: (65,)
Example structured train data: [( True, 20.) ( True, 36.) ( True, 30.) (False, 52.) ( True,  8.)]
Example structured test data: [(False, 52.) (False, 52.) (False, 52.) (False, 52.) ( True, 42.)]
Computing metrics for time point 1/9 (time=8.00)
Risk predictions for time 0: min=0.5685, max=1.1020, mean=0.9340
C-index for time 8.00: 0.7344
AUC for time 8.00: 0.6905
Computing metrics for time point 2/9 (time=13.80)
Risk predictions for time 1: min=1.0903, max=1.4436, mean=1.2547
C-index for time 13.80: 0.2963
AUC for time 13.80: 0.2957
Computing metrics for time point 3/9 (time=18.70)
Risk predictions for time 2: min=1.1611, max=2.1365, mean=1.5455
C-index for time 18.70: 0.3306
AUC for time 18.70: 0.3220
Computing metrics for time point 4/9 (time=24.00)
Risk predictions for time 3: min=1.3163, max=3.7164, mean=2.1825
C-index for time 24.00: 0.2900
AUC for time 24.00: 0.2797
Computing metrics for time point 5/9 (time=29.00)
Risk predictions for time 4: min=1.4094, max=4.6349, mean=2.5643
C-index for time 29.00: 0.3255
AUC for time 29.00: 0.3202
Computing metrics for time point 6/9 (time=35.40)
Risk predictions for time 5: min=1.5203, max=5.4457, mean=2.8767
C-index for time 35.40: 0.3529
AUC for time 35.40: 0.3434
Computing metrics for time point 7/9 (time=40.00)
Risk predictions for time 6: min=1.6252, max=6.7618, mean=3.2962
C-index for time 40.00: 0.2931
AUC for time 40.00: 0.2703
Computing metrics for time point 8/9 (time=45.00)
Risk predictions for time 7: min=1.6915, max=7.5127, mean=3.5658
C-index for time 45.00: 0.3699
AUC for time 45.00: 0.3699
Computing metrics for time point 9/9 (time=49.00)
Risk predictions for time 8: min=1.7951, max=9.3459, mean=4.0997
C-index for time 49.00: 0.3666
AUC for time 49.00: 0.3591
Survival predictions shape for Brier score: (65, 9)
Brier score computed: 0.2971
==================================================
Final test results for dataset Rossi:
Number of patients: 432
Number of eval time points: 9
Validation NLL: 1141.8924
Test C-index: 0.3666
Test Brier Score: 0.2971
Test mean AUC: 0.3612
Total runtime: 0h 15m 37s
