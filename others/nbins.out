Top 5 datasets where TabPFN has worst IBS relative to best baseline:
            dataset     ibs  best_baseline_ibs  ibs_difference
32          ovarian  0.3592             0.0962          0.2630
10             actg  0.2107             0.0608          0.1499
26            grace  0.3010             0.1639          0.1371
34  pharmacoSmoking  0.3599             0.2358          0.1241
39              rhc  0.3196             0.2012          0.1184

============================================================
n_bins Analysis on Top 5 Worst IBS Datasets
============================================================
Testing n_bins: [3, 5, 10, 15, 20, 25, 30]
Datasets: ['ovarian', 'actg', 'grace', 'pharmacoSmoking', 'rhc']

============================================================
Analyzing: ovarian
============================================================

Analyzing n_bins effect on dataset: ovarian
Evaluation times: [390.2 437.8 469.5 528.6 769.7]
Testing n_bins: [3, 5, 10, 15, 20, 25, 30]
  Training with n_bins=3...
    IBS: 0.3592, C-index: 0.5000, Mean AUC: 0.5000
  Training with n_bins=5...
    IBS: 0.2210, C-index: 0.8000, Mean AUC: 0.8333
  Training with n_bins=10...
    IBS: 0.2068, C-index: 0.8000, Mean AUC: 0.8333
  Training with n_bins=15...
    IBS: 0.2068, C-index: 0.8000, Mean AUC: 0.8333
  Training with n_bins=20...
    IBS: 0.2068, C-index: 0.8000, Mean AUC: 0.8333
  Training with n_bins=25...
    IBS: 0.2068, C-index: 0.8000, Mean AUC: 0.8333
  Training with n_bins=30...
    IBS: 0.2068, C-index: 0.8000, Mean AUC: 0.8333
✅ Analysis completed for ovarian

============================================================
Analyzing: actg
============================================================

Analyzing n_bins effect on dataset: actg
Evaluation times: [ 86.7 151.  195.1 230.8 256.5 273.  291.  311.  328. ]
Testing n_bins: [3, 5, 10, 15, 20, 25, 30]
  Training with n_bins=3...
    IBS: 0.2107, C-index: 0.8059, Mean AUC: 0.8305
  Training with n_bins=5...
    IBS: 0.1291, C-index: 0.7974, Mean AUC: 0.8295
  Training with n_bins=10...
    IBS: 0.0859, C-index: 0.5100, Mean AUC: 0.4732
  Training with n_bins=15...
    IBS: 0.0806, C-index: 0.4436, Mean AUC: 0.3759
  Training with n_bins=20...
    IBS: 0.0733, C-index: 0.4790, Mean AUC: 0.4130
  Training with n_bins=25...
    IBS: 0.0729, C-index: 0.4731, Mean AUC: 0.4071
  Training with n_bins=30...
    IBS: 0.0720, C-index: 0.4701, Mean AUC: 0.4337
✅ Analysis completed for actg

============================================================
Analyzing: grace
============================================================

Analyzing n_bins effect on dataset: grace
Evaluation times: [  3.    7.   15.   80.  176.5]
Testing n_bins: [3, 5, 10, 15, 20, 25, 30]
  Training with n_bins=3...
    IBS: 0.3010, C-index: 0.6134, Mean AUC: 0.5764
  Training with n_bins=5...
    IBS: 0.2932, C-index: 0.6290, Mean AUC: 0.6035
  Training with n_bins=10...
    IBS: 0.3162, C-index: 0.6053, Mean AUC: 0.5795
  Training with n_bins=15...
    IBS: 0.3802, C-index: 0.6080, Mean AUC: 0.5789
  Training with n_bins=20...
    IBS: 0.4042, C-index: 0.6160, Mean AUC: 0.6045
  Training with n_bins=25...
    IBS: 0.4267, C-index: 0.5967, Mean AUC: 0.5805
  Training with n_bins=30...
    IBS: 0.4387, C-index: 0.6015, Mean AUC: 0.5750
✅ Analysis completed for grace

============================================================
Analyzing: pharmacoSmoking
============================================================

Analyzing n_bins effect on dataset: pharmacoSmoking
Evaluation times: [ 1.  4. 14. 28. 56. 77.]
Testing n_bins: [3, 5, 10, 15, 20, 25, 30]
  Training with n_bins=3...
    IBS: 0.3599, C-index: 0.6744, Mean AUC: 0.7468
  Training with n_bins=5...
    IBS: 0.3018, C-index: 0.5698, Mean AUC: 0.6056
  Training with n_bins=10...
    IBS: 0.4695, C-index: 0.6512, Mean AUC: 0.6828
  Training with n_bins=15...
    IBS: 0.4050, C-index: 0.5814, Mean AUC: 0.6666
  Training with n_bins=20...
    IBS: 0.4512, C-index: 0.5814, Mean AUC: 0.6424
  Training with n_bins=25...
    IBS: 0.4390, C-index: 0.6279, Mean AUC: 0.6729
  Training with n_bins=30...
    IBS: 0.4433, C-index: 0.6512, Mean AUC: 0.6996
✅ Analysis completed for pharmacoSmoking

============================================================
Analyzing: rhc
============================================================

Analyzing n_bins effect on dataset: rhc
Evaluation times: [  5.   11.   23.   57.  166.5 190.  215.  238.  417.4]
Testing n_bins: [3, 5, 10, 15, 20, 25, 30]
  Training with n_bins=3...
    IBS: 0.3196, C-index: 0.7110, Mean AUC: 0.7478
  Training with n_bins=5...
    IBS: 0.2061, C-index: 0.7147, Mean AUC: 0.7601
  Training with n_bins=10...
    IBS: 0.2003, C-index: 0.7137, Mean AUC: 0.7671
  Training with n_bins=15...
    Failed: CUDA error: invalid configuration argument
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

  Training with n_bins=20...
    Failed: CUDA error: invalid configuration argument
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

  Training with n_bins=25...
    Failed: CUDA error: invalid configuration argument
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

  Training with n_bins=30...
    Failed: CUDA error: invalid configuration argument
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

✅ Analysis completed for rhc

============================================================
Creating Summary Plots
============================================================

============================================================
SUMMARY: n_bins Effect Analysis
============================================================

ovarian:
  n_bins | IBS    | C-index | Mean AUC
  -------|--------|---------|----------
       3 | 0.3592 | 0.5000  | 0.5000
       5 | 0.2210 | 0.8000  | 0.8333
      10 | 0.2068 | 0.8000  | 0.8333
      15 | 0.2068 | 0.8000  | 0.8333
      20 | 0.2068 | 0.8000  | 0.8333
      25 | 0.2068 | 0.8000  | 0.8333
      30 | 0.2068 | 0.8000  | 0.8333
  Best IBS: n_bins=10 (0.2068)
  Best C-index: n_bins=5 (0.8000)
  Best Mean AUC: n_bins=5 (0.8333)

actg:
  n_bins | IBS    | C-index | Mean AUC
  -------|--------|---------|----------
       3 | 0.2107 | 0.8059  | 0.8305
       5 | 0.1291 | 0.7974  | 0.8295
      10 | 0.0859 | 0.5100  | 0.4732
      15 | 0.0806 | 0.4436  | 0.3759
      20 | 0.0733 | 0.4790  | 0.4130
      25 | 0.0729 | 0.4731  | 0.4071
      30 | 0.0720 | 0.4701  | 0.4337
  Best IBS: n_bins=30 (0.0720)
  Best C-index: n_bins=3 (0.8059)
  Best Mean AUC: n_bins=3 (0.8305)

grace:
  n_bins | IBS    | C-index | Mean AUC
  -------|--------|---------|----------
       3 | 0.3010 | 0.6134  | 0.5764
       5 | 0.2932 | 0.6290  | 0.6035
      10 | 0.3162 | 0.6053  | 0.5795
      15 | 0.3802 | 0.6080  | 0.5789
      20 | 0.4042 | 0.6160  | 0.6045
      25 | 0.4267 | 0.5967  | 0.5805
      30 | 0.4387 | 0.6015  | 0.5750
  Best IBS: n_bins=5 (0.2932)
  Best C-index: n_bins=5 (0.6290)
  Best Mean AUC: n_bins=20 (0.6045)

pharmacoSmoking:
  n_bins | IBS    | C-index | Mean AUC
  -------|--------|---------|----------
       3 | 0.3599 | 0.6744  | 0.7468
       5 | 0.3018 | 0.5698  | 0.6056
      10 | 0.4695 | 0.6512  | 0.6828
      15 | 0.4050 | 0.5814  | 0.6666
      20 | 0.4512 | 0.5814  | 0.6424
      25 | 0.4390 | 0.6279  | 0.6729
      30 | 0.4433 | 0.6512  | 0.6996
  Best IBS: n_bins=5 (0.3018)
  Best C-index: n_bins=3 (0.6744)
  Best Mean AUC: n_bins=3 (0.7468)

rhc:
  n_bins | IBS    | C-index | Mean AUC
  -------|--------|---------|----------
       3 | 0.3196 | 0.7110  | 0.7478
       5 | 0.2061 | 0.7147  | 0.7601
      10 | 0.2003 | 0.7137  | 0.7671
  Best IBS: n_bins=10 (0.2003)
  Best C-index: n_bins=5 (0.7147)
  Best Mean AUC: n_bins=10 (0.7671)

============================================================
Generated figures:
  figures/nbins_analysis/ovarian_metrics_comparison.png (3 main metrics)
  figures/nbins_analysis/ovarian_time_specific_brier_nbins.png (time-specific Brier)
  figures/nbins_analysis/actg_metrics_comparison.png (3 main metrics)
  figures/nbins_analysis/actg_time_specific_brier_nbins.png (time-specific Brier)
  figures/nbins_analysis/grace_metrics_comparison.png (3 main metrics)
  figures/nbins_analysis/grace_time_specific_brier_nbins.png (time-specific Brier)
  figures/nbins_analysis/pharmacoSmoking_metrics_comparison.png (3 main metrics)
  figures/nbins_analysis/pharmacoSmoking_time_specific_brier_nbins.png (time-specific Brier)
  figures/nbins_analysis/rhc_metrics_comparison.png (3 main metrics)
  figures/nbins_analysis/rhc_time_specific_brier_nbins.png (time-specific Brier)
  figures/nbins_analysis/summary_nbins_analysis.png

============================================================
Key Insights:
- Calibration (IBS, Brier scores): Should improve with more bins (finer discretization)
- Discrimination (C-index, AUC): Should remain relatively stable across n_bins
- Optimal n_bins may differ between calibration and discrimination metrics
- Trade-off between calibration improvement and computational complexity
============================================================
Total runtime: 0h 2m 50s
